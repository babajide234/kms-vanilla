<!doctype html>
<html title="home">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <link rel="stylesheet" href="style.css" type="text/css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.3/gsap.min.js"></script>

  <script src="https://unpkg.com/lucide@latest"></script>
  <script>

    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: "#991313",
            bgsecond: "#f1efef",
            text: "#3a3737",
            textsub: "#9a9898",
            border: "#c2bdbd",
            hemp: "#8a7474",
            accent1: "#c39494",
            accent2: "#cdacac",
            sirocco: "#6c7474",
          }
        }
      }
    }

    lucide.createIcons();

  </script>
</head>
<body>
    <div class="flex w-full h-screen overflow-y-hidden">
        <div id="sidebar" class="w-[20%] h-full bg-bgsecond pt-24 hidden md:block">
            <div class=" absolute top-5 left-5 flex gap-2 items-center text-white">
                <div class="">
                    <img src="./img/logo.png" alt="" class=" w-8  ">
                </div>
                <div class="">
                    <h2 class=" font-bold text-sm text-primary">Custodian</h2>
                    <p class=" text-textsub text-xs">Knowledge management System</p>
                </div>
            </div>
            <div class=" py-5">
                <div class="dropdown flex w-[80%] mx-auto rounded-lg flex-col  bg-white relative z-0">
                    <a href="./content.html" class="flex text-primary items-center px-2.5 py-[15px] rounded-lg gap-4 text-sm font-medium">
                        <span class="">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus"><path d="M5 12h14"/><path d="M12 5v14"/></svg>
                        </span>
                        Create new content
                    </a>
                </div>
            </div>
        </div>
        <div class=" flex-1 p-8 overflow-y-scroll">
            <div class=" flex items-center justify-between mb-10">
                <div class=" w-full md:flex-grow">
                    <h1 class=" font-bold text-2xl text-text mb-1">Update request</h1>
                </div>
                <div class="hidden md:flex items-center gap-3">
                    <div class=" bg-[#F5F5F5] rounded-full flex items-center px-4 py-3 focus-within:border border-bg-primary  md:w-[300px]">
                        <!-- <IoSearch class="mr-2 text-xl text-red-800"/> -->
                        <i class="mr-2">
                          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                              <path d="M17.5 17.5L13.875 13.875M15.8333 9.16667C15.8333 12.8486 12.8486 15.8333 9.16667 15.8333C5.48477 15.8333 2.5 12.8486 2.5 9.16667C2.5 5.48477 5.48477 2.5 9.16667 2.5C12.8486 2.5 15.8333 5.48477 15.8333 9.16667Z" stroke="#900000" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
                          </svg>
                        </i>
                        <input type="text" class=" flex-grow bg-[#F5F5F5] focus:outline-none " id="searchInput" placeholder="Search" />
                      </div>
                    <button class=" bg-[#F5F5F5] w-[48px] h-[48px] rounded-full flex justify-center items-center" type="">
                        <i class="">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                                <path d="M9.35395 21C10.0591 21.6224 10.9853 22 11.9998 22C13.0142 22 13.9405 21.6224 14.6456 21M17.9998 8C17.9998 6.4087 17.3676 4.88258 16.2424 3.75736C15.1172 2.63214 13.5911 2 11.9998 2C10.4085 2 8.88235 2.63214 7.75713 3.75736C6.63192 4.88258 5.99977 6.4087 5.99977 8C5.99977 11.0902 5.22024 13.206 4.34944 14.6054C3.6149 15.7859 3.24763 16.3761 3.2611 16.5408C3.27601 16.7231 3.31463 16.7926 3.46155 16.9016C3.59423 17 4.19237 17 5.38863 17H18.6109C19.8072 17 20.4053 17 20.538 16.9016C20.6849 16.7926 20.7235 16.7231 20.7384 16.5408C20.7519 16.3761 20.3846 15.7859 19.6501 14.6054C18.7793 13.206 17.9998 11.0902 17.9998 8Z" stroke="#900000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                              </svg>
                        </i>
                    </button>
                </div>
            </div>
            <div class=" flex flex-col md:flex-row md:items-center justify-between">
                <div class=" w-full md:w-fit mb-3 md:mb-0 px-1 py-1 flex items-center justify-between md:gap-3">
                  <div class="dropdown relative">
                      <button data-tag="all" class=" text-[#606060] group   text-md md:text-md border border-solid border-[#606060] rounded-full py-[10px] px-[20px] flex gap-3 items-center">
                        <span class="text max-w-[150px] truncate">All</span>
                        <span class="  ">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M5 7.5L10 12.5L15 7.5" stroke="#606060" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </span>
                      </button>
                      <div data-dropdown class=" hidden w-[271px] px-5 py-[15px] bg-white flex flex-col text-sm text-[#3F3F3F] gap-[10px] shadow-md absolute top-[3rem] left-0 z-[100] rounded-lg ">
                            <button data-sub="all" class="py-1 hover:bg-gray-50 rounded-sm">All</button>
                      </div>
                  </div>
                  <div class=" border-solid border-l-2 py-5 border-gray-300 "></div>
                  <div class="dropdown relative" id="type">
                        <button data-tag="ContentType" class=" text-[#606060] border border-solid border-[#606060] group  text-md md:text-md  rounded-full py-[10px] px-[20px] flex gap-3 items-center">
                            <span class="text max-w-[150px] truncate">ContentType</span>
                            <span class="  ">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M5 7.5L10 12.5L15 7.5" stroke="#606060" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                            </span>
                        </button>
                        <div data-dropdown class=" hidden w-[271px] px-5 py-[15px] bg-white flex flex-col text-sm text-[#3F3F3F] gap-[10px] shadow-md absolute top-[3rem] left-0 z-[100] rounded-lg ">
                            
                        </div>
                    </div>
                  <div class="dropdown relative" id="organization">
                      <button data-tag="SubsidiaryId" class=" text-[#606060] group   text-md md:text-md border border-solid border-[#606060] rounded-full py-[10px] px-[20px] flex gap-3 items-center">
                        <span class="text max-w-[150px] truncate">Subsidiary</span>
                        <span class="  ">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M5 7.5L10 12.5L15 7.5" stroke="#606060" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </span>
                      </button>
                      <div data-dropdown class=" hidden w-[271px] px-5 py-[15px] bg-white flex flex-col text-sm text-[#3F3F3F] gap-[10px] shadow-md absolute top-[3rem] left-0 z-[100] rounded-lg ">
                            
                      </div>
                  </div>
                  <div class="dropdown relative" id="department">
                      <button data-tag="DeptId" class=" text-[#606060] group  text-md md:text-md border border-solid border-[#606060] rounded-full py-[10px] px-[20px] flex gap-3 items-center">
                        <span class="text max-w-[150px] truncate">Department</span>
                        <span class="  ">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M5 7.5L10 12.5L15 7.5" stroke="#606060" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </span>
                      </button>
                      <div data-dropdown class=" hidden w-[271px] px-5 py-[15px] bg-white flex flex-col text-sm text-[#3F3F3F] gap-[10px] shadow-md absolute top-[3rem] left-0 z-[100] rounded-lg ">
                            
                      </div>
                  </div>

                </div>
            </div>
            <div class=" dashboard-content grid grid-cols-1 md:grid-cols-3 py-10 gap-5">
                <div class=" w-full col-span-full rounded-t-lg border bordder-solid border-gray-200  overflow-hidden ">
                    <div class="">
                        <div class="bg-red-100 py-2 px-4 w-full grid grid-cols-5 ">
                            <div class=" w-full px-[24px] py-2 font-semibold text-[#606060] text-sm capitalize">name</div>
                            <div class=" w-full px-[24px] py-2 font-semibold text-[#606060] text-sm capitalize">category</div>
                            <div class=" w-full px-[24px] py-2 font-semibold text-[#606060] text-sm capitalize">description</div>
                            <div class=" w-full px-[24px] py-2 font-semibold text-[#606060] text-sm capitalize">attachment</div>
                            <div class=" w-full px-[24px] py-2 font-semibold text-[#606060] text-sm capitalize">status</div>
                        </div>
                    </div>
                    <div class="requestTable">
                        <div class=" grid grid-cols-5 border-b border-solid border-gray-200">
                            <div class=" w-full  py-[16px] px-[24px] text-sm">Policy and Procedures</div>
                            <div class=" w-full  py-[16px] px-[24px] text-sm">
                                <div class="w-20 h-6 px-5 py-1 bg-neutral-100 rounded-3xl justify-center items-center gap-2.5 flex text-red-950 text-xs font-normal">
                                    Article
                                </div>
                            </div>
                            <div class=" w-full  py-[16px] px-[24px] text-sm">
                                <p class="">
                                    Overall, I appreciate the creativity and effort put into the campaign, especially the eye-catching visuals
                                </p>
                            </div>
                            <div class=" w-full  py-[16px] px-[24px] text-sm">
                                <div class="w-full  p-2.5 bg-white rounded border border-solid border-red-800 justify-start items-center gap-2 inline-flex">
                                        <div class="text-center text-white text-xs font-bold bg-red-500 p-1 rounded">PDF</div>
                                        <div class=" flex-col justify-start items-start gap-2 flex">
                                            <div class="self-stretch h-7 flex-col justify-start items-start flex">
                                                <h2 class="self-stretch text-zinc-600 text-xs font-normal leading-none">Tech design requirements.pdf</h2>
                                                <p class="self-stretch text-zinc-500 text-xs font-normal leading-none">200 KB</p>
                                            </div>
                                        </div>
                                </div>
                            </div>
                            <div class=" w-full  py-[16px] px-[24px] text-sm">
                                <div class="w-20 h-6 px-5 py-1 bg-amber-100 rounded-3xl justify-center items-center gap-2.5 flex text-amber-600 text-xs font-normal  leading-none">
                                    <div class="">Pending</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <div class="more fixed hidden w-full h-screen bg-[#808080BF] flex items-center justify-end ">
            <div class="more-modal w-[529px] py-[20px] bg-[#F5F5F5] h-screen relative overflow-y-scroll ">
                <div class="pb-[13px] px-[20px]  border-solid border-b border-[#DBDBDB] flex justify-between items-center">
                    <h2 class=" more-title text-[22px] font-semibold"></h2>
                    <button onclick="moretoggle()" class=" p-2 rounded-lg hover:bg-gray-50">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M15.0005 5L5.00049 15M5.00049 5L15.0005 15" stroke="#606060" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                          </svg>
                    </button>
                </div>
                <div class="more-content">
                    
                </div>

                <div class=" p-5  bg-[#F5F5F5] w-full grid grid-cols-2 gap-5">
                    <!-- <button class=" w-full px-[14px] py-[10px] rounded-md bg-white text-primary font-semibold">Download</button> -->
                    <button onclick="moretoggle()" class=" w-full px-[14px] py-[10px] rounded-md bg-primary text-white font-semibold">Approve</button>
                </div>
            </div>
        </div>
    </div>
    <script src="./common.js"></script>

    <script >
        $(document).ready(function () {

            loadSidebar();
            populateTable();

            $('nav a').click(function (e) {
                e.preventDefault();
                const route = $(this).attr('href').substring(1);
                loadContent(route);
            });

            $('#sidebar .dropdown-toggle').click(function () {
                const $dropdownContent = $(this).siblings('.dropdown-content');
                $dropdownContent.toggleClass('h-0 h-fit');
            });

            $('.request').click(function () {
                const $requestId = $(this).data('id')
                console.log($requestId);
                modal()
                renderMoreContent($requestId)
            });


            $('#searchInput').on('input', function () {
                const searchText = $(this).val().toLowerCase();
                filterContentBySearch(searchText);
            });

            populateDropdown(Subsidiaries, 'organization');
            populateDropdown(ContentTypes, 'type');
            populateDropdown(Departments, 'department');
            
            let filterObject = {};

            $('.dropdown').each(function () {
                const $button = $(this).find('[data-tag]');
                const $dropdown = $(this).find('[data-dropdown]');
            
                let currentSelectedValue = ""; 


                $button.click(function (e) {
                    e.stopPropagation(); 
                    $dropdown.toggleClass('hidden');
                });

                $dropdown.find('[data-sub]').click(function () {
                    const selectedValue = $(this).data('sub');

                    // Check if the selected value is already the current selected value
                    if (filterObject[$button.data('tag')] === selectedValue) {
                        // If it is the same value, remove the selection
                        filterObject[$button.data('tag')] = ""; // Clear the selected value from filterObject
                        $button.find('.text').text($button.data('tag')); // Clear the button text
                        $(this).removeClass('bg-primary text-white'); // Remove the styling from the selected option
                    } else {
                        // Update the filter object
                        filterObject[$button.data('tag')] = selectedValue;


                        // filterContent(filterObject);

                        currentSelectedValue = selectedValue; // Update the current selected value
                        $button.find('.text').text(selectedValue);
                        $dropdown.addClass('hidden');

                        $dropdown.find('[data-sub]').removeClass('bg-primary text-white');
                        $(this).addClass('bg-primary text-white');

                        if ($(this).attr('data-sub')) {
                            $button.removeClass('text-[#606060] border border-solid border-[#606060]').addClass('bg-primary text-white');
                        } else {
                            // If data-sub attribute is not present, you can add an else statement to handle that case
                        }
                    }
                });


                $(document).click(function () {
                    $dropdown.addClass('hidden');
                });
            });
            
            // filterContent('all');
            // markActiveTag('all');

        });
        
        function populateTable(){
            const $requestContent = $('.requestTable');
            $requestContent.empty();
            $content= updaterequest.Result

            $content.forEach(item=>{
                $requestContent.append(
                    `<div data-id="${item.ContentId}" class="request grid grid-cols-5 hover:cursor-pointer hover:bg-gray-50 border-b border-solid border-gray-200">
                        <div class=" w-full  py-[16px] px-[24px] text-sm">${item.Title}</div>
                        <div class=" w-full  py-[16px] px-[24px] text-sm">
                            <div class="w-20 h-6 px-5 py-1 bg-neutral-100 rounded-3xl justify-center items-center gap-2.5 flex text-red-950 text-xs font-normal">
                                ${item.ContentType}
                            </div>
                        </div>
                        <div class=" w-full  py-[16px] px-[24px] text-sm">
                            <p class="">
                                ${item.Description}
                            </p>
                        </div>
                        <div class=" w-full  py-[16px] px-[24px] text-sm">
                            <div class="w-full  p-2.5 bg-white rounded border border-solid border-red-800 justify-start items-center gap-2 inline-flex">
                                    <div class="text-center text-white text-xs font-bold bg-red-500 p-1 rounded">PDF</div>
                                    <div class=" flex-col justify-start items-start gap-2 flex">
                                        <div class="self-stretch h-7 flex-col justify-start items-start flex">
                                            <h2 class="self-stretch text-zinc-600 text-xs font-normal leading-none">Tech design requirements.pdf</h2>
                                            <p class="self-stretch text-zinc-500 text-xs font-normal leading-none">200 KB</p>
                                        </div>
                                    </div>
                            </div>
                        </div>
                        <div class=" w-full  py-[16px] px-[24px] text-sm">
                            <div class="w-20 h-6 px-5 py-1 bg-amber-100 rounded-3xl justify-center items-center gap-2.5 flex text-amber-600 text-xs font-normal  leading-none">
                                <div class="">${item.Status}</div>
                            </div>
                        </div>
                    </div>
                `
                )
            })
        }

        function renderMoreContent(id){
            const data = updaterequest.Result;
            const request = data.find(item => item.ContentId === id);

            const $moreContiner = $('.more-content');

            $moreContiner.empty();
            $('.more-title').empty();

            $('.more-title').append(`${request.Title}`);

            if(request.ContentType=== 'Document'){
                $moreContiner.append(`
                        <div class="py-5 px-5 border-solid border-b border-[#DBDBDB] flex flex-col gap-[15px] ">
                            <h2 class=" text-[15px] font-semibold">Decription</h2>
                            <p class=" text-[#808080] text-sm">
                                ${request.Description}
                            </p>
                        </div>
                        <div class="py-5 px-5 border-solid border-b border-[#DBDBDB] flex justify-between items-center ">
                            <h2 class=" text-[15px] text-[#606060]">Category</h2>
                            <p class="">${request.Description}</p>
                        </div>
                        <div class="py-5 px-5 border-solid border-b border-[#DBDBDB] flex justify-between items-center ">
                            <h2 class=" text-[15px] text-[#606060]">Subsidiary</h2>
                            
                            ${getSubsidiary(request.SubsidiaryId)}
                        </div>
                        <div class="py-5 px-5 border-solid border-b border-[#DBDBDB] flex justify-between items-center ">
                            <h2 class=" text-[15px] text-[#606060]">Department</h2>
                            <p class="">${getDepartment(request.DeptId)}</p>
                        </div>
                `);    
            }
        }

        function populateDropdown(data, dropdownId) {
            const dropdown = $(`#${dropdownId} [data-dropdown]`);
            data.forEach(item => {
                const button = `<button data-sub="${item.name}" class="py-1 hover:bg-gray-50 hover:text-primary text-left px-10 rounded-sm">${item.name}</button>`;
                dropdown.append(button);
            });
        }
        function getSubsidiary(selectedId) {
            const subsidiaries = Subsidiaries; // Assuming Subsidiaries is an array of subsidiary objects
            const selectElement = $('<select name="" id="" class=" p-2 rounded bg-"></select>');

            // Create an empty option as the default

            // Populate options with subsidiaries
            subsidiaries.forEach(subsidiary => {
                const optionElement = $(`<option value="${subsidiary.id}">${subsidiary.name}</option>`);

                // Check if the subsidiary's ID matches the selectedId
                if (subsidiary.id === selectedId) {
                    optionElement.prop('selected', true);
                }

                selectElement.append(optionElement);
            });

            return selectElement.prop('outerHTML'); // Return the outerHTML string
        }
        function getDepartment(selectedId) {
            const Department = Departments; // Assuming Subsidiaries is an array of subsidiary objects
            const selectElement = $('<select name="" id="" class=" p-2 rounded bg-"></select>');

            // Create an empty option as the default

            // Populate options with subsidiaries
            Department.forEach(Dep => {
                const optionElement = $(`<option value="${Dep.id}">${Dep.name}</option>`);

                if (Dep.id === selectedId) {
                    optionElement.prop('selected', true);
                }

                selectElement.append(optionElement);
            });

            return selectElement.prop('outerHTML'); // Return the outerHTML string
        }     


        function modal(id){
            console.log(id)
            moretoggle()
        }
        
        function moretoggle(){
            $('.more').toggleClass('hidden');
            animateMore()
        }

        function loadSidebar() {
            const $nav = $('#sidebar');
            console.log(menu);

            menu.forEach(item => {
                if (item.header) {
                    $nav.append(`<h2 class="uppercase mb-5 text-sm font-semibold mx-5 text-gray-500">${item.header}</h2>`);
                } else {
                    if (item.children) {
                        // Dropdown item
                        $nav.append(`<div class="flex flex-col">
                                        <div class=" dropdown-toggle flex justify-between items-center text-[#606060] text-md px-5 py-2 hover:bg-red-800 hover:text-white hover:cursor-pointer w-11/12 rounded-e-md mb-3 capitalize font-normal">
                                            <span class="flex items-center "><i class=" mr-3 text-md">${item.icon}</i><span>${item.name}</span> </span>  <i class=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down"><path d="m6 9 6 6 6-6"/></svg></i>
                                        </div>
                                        <div class="  dropdown-content px-5 flex flex-col h-0 overflow-hidden transition-all duration-500 ease-in-out">
                                            ${item.children.map(child => `<a href="${child.url}" class="px-5 py-2 hover:bg-red-800 hover:text-white w-11/12 rounded-e-md mb-3 capitalize font-normal">${child.name}</a>`).join('')}
                                        </div>
                                    </div>`);
                    } else {
                        // Regular item without dropdown
                        $nav.append(`<a href="${item.url}" class="flex items-center group text-[#606060] text-md px-5 py-2 hover:bg-red-800 hover:text-white hover:cursor-pointer w-11/12 rounded-e-md mb-3 capitalize font-normal">
                                        <i class=" mr-3 text-md">${item.icon}</i><span>${item.name}</span>
                                    </a>`);
                    }
                }
            });
        }
        
        function animateMore(index) {
            gsap.timeline()
                .from( '.more', {
                    opacity: 0, 
                    duration:0.5,
                }).to(
                    '.more',{
                        opacity: 1, 
                        duration: 0.5
                    }
                ).from('.more-modal',{
                    x:'100%',
                    duration: 0.3
                }).to('.more-modal',{
                    x:0,
                    duration: 0.3
                })
                
        }
    </script>
</body>
</html>